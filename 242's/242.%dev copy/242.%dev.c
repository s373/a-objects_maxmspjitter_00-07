//   242.cauchy   \ probal cause for alteration//		 image distribution//		a image distribution//////								09/03/2001 / s//////////modified/para poulyv.15.10.01-->3 channels akademie//  dial 			map_beta(x->low, x->high, x->a, x->b)		//   cauchy.  A * tan((rnd-.5)*pi)#define _VERSION_      18102001#include "Movies.h"#include "ext_common.h"#include "ext.h"#include "ext_user.h"#include <math.h>#include <stdlib.h>#include "n2.basicstrings.c"#include "n2.0000.h"     // nato.inkludes//object data structuretypedef struct zttz {	Object   n_ob;     // required max 	void     *n2hdr;   // required nato - position = signifikant _ must b 2nd		void             *dataout;      // n2data outlet	n2imgptr         gvelt;         // img buffer	long               v1, v2, divx, divy, plus,debug;	short		 mode, variant;	double 		ra, rb;	    Boolean          on,bypass,freeze,think,quarrel;  // nato.objstate flagz} NNato;// prototypesvoid *nnato_new(short variant);void nnato_assist(NNato *x, void *b, long msg, long nr, char *s);void nnato_info(NNato *x, void *p, void *b);void nnato_free(NNato *x);void nnato_processimage(NNato *x, n2atom *data);		// x +void nnato_processimage2(NNato *x, n2atom *data);	 // y +void nnato_processimage3(NNato *x, n2atom *data);       // x /void nnato_processimage4(NNato *x, n2atom *data);	// y /void nnato_processimage5(NNato *x, n2atom *data);	// x / 655void nnato_processimage6(NNato *x, n2atom *data);	// x + 655void nnato_processimage7(NNato *x, n2atom *data);	// 3x + *655void nnato_processimage8(NNato *x, n2atom *data);	//vray controvoid nnato_processimage9(NNato *x, n2atom *data);void nnato_on(NNato *x, long flag);void nnato_bypass(NNato *x, long flag);void nnato_freeze(NNato *x, long flag);void nnato_think(NNato *x, short val);void nnato_quarrel(NNato *x, short val);void nnato_bang(NNato *x);void nnato_int(NNato *x, long n);   void nnato_mode(NNato *x,   short mode);void nnato_v1(NNato *x,long v1);void nnato_v2(NNato *x,  long v2);void nnato_ra(NNato *x, double ra);void nnato_rb(NNato *x, double rb);void nnato_plus(NNato *x, long plus);void nnato_divx(NNato *x, long val);void nnato_divy(NNato *x, long val);void nnato_div(NNato *x, long val);void nnato_variant(NNato *x, short variant);double map_alpha(NNato *x);double map_beta(double low, double high, double a, double b, double mu, double sigsqr) ;double beta_value(double a, double b);double non_zero_random(void);double ran(void);double alea(double min, double max);double mapvalue(double x, double a, double b, double c, double d);void nnato_debug(NNato *x, long val);void     *nnato_class;main(void){	setup(&nnato_class, nnato_new, (method)nnato_free, (short)sizeof(NNato), 0L, 	      A_DEFLONG, 0);    n2objaddimagecmd();    n2addstatecmd((method)nnato_int,(method)nnato_bang,                  (method)nnato_on,(method)nnato_freeze,(method)nnato_bypass,                  (method)nnato_think,(method)nnato_quarrel,(method)nnato_variant,0); 	addmess((method)nnato_assist,	                   "assist",    	A_CANT,0); 	addmess((method)nnato_info,	                       "info",		    A_CANT,0);    addmess((method)nnato_mode,                     "mode",           A_DEFLONG,0);    addmess((method)nnato_v1,                   "v1",         A_DEFLONG,0);    addmess((method)nnato_v2,                    "v2",          A_DEFLONG,0);    addmess((method)nnato_ra,                        "a",           A_DEFFLOAT,0);    addmess((method)nnato_rb,                        "b",           A_DEFFLOAT,0);    addmess((method)nnato_plus,                        "+",           A_DEFLONG,0);		// mode, v1, v2, ra, rb, divx, divy, plus, variant          addmess((method)nnato_divx,                   "/x",          A_DEFLONG,0);     addmess((method)nnato_divy,                   "/y",          A_DEFLONG,0);     addmess((method)nnato_div,                   "/",          A_DEFLONG,0);          addmess((method)nnato_debug,                   "debug",          A_DEFLONG,0);//    n2addfklass("242.\%dev");        post("242.\% dev   -  [revised:%ldsier",nnato_class, _VERSION_);}void nnato_assist(NNato *x, void *b, long msg, long nr, char *s){	if (msg == 1)      // inlet			sprintf(s, "nato.imag.var%ld", x->divx);    else       {	   if (msg == 2)   // outlet	      if (nr == 0)	      	if  (!x->quarrel)			      	sprintf(s, "no quarrel & high  %ld",x->divx);		        else  sprintf(s, "quarrelling & & high  %ld",x->variant);       }}void nnato_info(NNato *x, void *p, void *b){      n2info();}void *nnato_new(short variant){	NNato      *x;    short      err;  		x = (NNato *)newobject(nnato_class);    n2addoutlet(x,&x->dataout);        if (err = n2objinit(x))       { post("242.dev  :  n2objinit err = %ld",err); return;}            if ((err = n2inewimage(&x->gvelt,n2idefwidth,n2idefheight)))       { post("242.dev  :  n2inewimage err = %ld",err); goto ikk;}      n2objsetimagefun(x,(method)nnato_processimage);		// igniting...	if(variant) x->variant = variant; else  x->variant = 0;	x->mode = 0;     x->v1 = 1;	  x->v2 = 110;	  x->ra = 0.;	x->rb=1.;		x->plus=0;		x->debug=0;   	x->on = true;    x->bypass = x->freeze = x->think = x->quarrel = false;           return (x);ikk:	nnato_free(x);}void nnato_free(NNato *x){    if (x->gvelt) { n2idisposeimage(x->gvelt); x->gvelt = 0;}    n2objfree(x);}void nnato_on(NNato *x, long flag){        x->on = flag;}    void nnato_bypass(NNato *x, long flag){        x->bypass = flag;}      void nnato_freeze(NNato *x, long flag){        x->freeze = flag;} void nnato_int(NNato *x, long n)    {								       n2defintstatefun(x,n);}void nnato_bang(NNato *x){   n2registerimage(x,n2objtype,x->dataout,0,x->gvelt);			// &what!?          ,&data,}void nnato_mode(NNato *x,   short mode){   x->mode = mode;}void nnato_v1(NNato *x, long v1){   x->v1 = v1;}void nnato_v2(NNato *x, long v2){   x->v2 = v2;}void nnato_ra(NNato *x, double ra){   x->ra  = ra; if (x->debug) post("242dev::a:%f",x->ra);}void nnato_rb(NNato *x, double rb){   x->rb = rb;}void nnato_plus(NNato *x, long plus){   x->plus = plus;}void nnato_divx(NNato *x, long val){        x->divx=val;}void nnato_divy(NNato *x, long val){        x->divy=val;}void nnato_div(NNato *x, long val){        x->divx=x->divy = val;}void nnato_debug(NNato *x, long val){        x->debug = val;}double map_alpha(NNato *x){	double a , b;	a=x->ra; b=x->rb;	if (x->debug) post("242dev::a:%f\n242dev::a:%f",x->ra,x->rb);	return (  alea(a, b)  );}double map_beta(double low, double high, double a, double b, double mu, double sigsqr) 			//			ŒcŒv  paul.d  randbeta.c{	return(mapvalue(beta_value(a, b), mu, sigsqr,low, high));}// // beta distribution algorithm derived from Dodge's FORTRAN example, some of // the same variable names are used a and b should be doubles 0-1 // value returned between 0 and 1 //double beta_value(double a, double b){		double y1, y2, sum, ainv, binv;		ainv = 1.0/a;	binv = 1.0/b;	do 	{	 	y1 = pow(non_zero_random(), ainv);	 	y2 = pow(non_zero_random(), binv);	 	sum = y1+y2;	}	while(sum  > 1.0);		return(y1 / sum);}// // returns a non-zero random number between 0 and 1 // double non_zero_random(void){	double value;	do 	{		value = ran();	}	   	while (value == 0.0);		return(value);}// // returns a random double between 0 and 1 //double ran(void){		return(alea(0.0, 1.0));}//// returns a random value as double between min and max value // ANSI says that RAND_MAX = 32767, pretty piss poor I say!//double alea(double min, double max){	if (max >= min)		return ((max-min)*((double)rand()/RAND_MAX) + min);	else		return ((min-max)*((double)rand()/RAND_MAX) + max);	}//// maps x in the range a-b to the range c-d  returns a double //	double mapvalue (double x, double a, double b, double c, double d) {		return((x - a) * (d-c)/(b-a) + c);}void nnato_variant(NNato *x, short variant){   if (!variant)       n2objsetimagefun(x,(method)nnato_processimage);    else if (variant==1)       n2objsetimagefun(x,(method)nnato_processimage2);   else if (variant==2)       n2objsetimagefun(x,(method)nnato_processimage3);   else if (variant==3)       n2objsetimagefun(x,(method)nnato_processimage4);   else if (variant==4)       n2objsetimagefun(x,(method)nnato_processimage5);   else if (variant==5)       n2objsetimagefun(x,(method)nnato_processimage6);          else if (variant==6)       n2objsetimagefun(x,(method)nnato_processimage7);          else if (variant==7)       n2objsetimagefun(x,(method)nnato_processimage8);          else if (variant==8)       n2objsetimagefun(x,(method)nnato_processimage9);}void nnato_think(NNato *x, short val){   x->think = val;}void nnato_quarrel(NNato *x, short val){   x->quarrel = val;}void nnato_processimage(NNato *x, n2atom *data){                       long           i, j, k, l, roubitez, pix, gout                      ;                              short          width, height, err, mode = x->mode;                        	long		  		v1 = x->v1,					v2 = x->v2,					plus = x->plus,					dx = x->divx,					dy = x->divy	;	double			z		,  vangh, vangw					;    Ptr            src, dst, srcadresz, dstadresz;          n2pixmaphdl    srcpixmap, dstpixmap;    n2pixstate     srcpixztate, dstpixztate;    n2imgptr       dstgvelt, gveltptr = n2getatomimage(data);        if (!x->on || !gveltptr) return;        if (x->freeze)           {                 n2registerimage(x,n2objtype,x->dataout,data,x->gvelt);              return;           }                       if (x->bypass)           {              n2registerimage(x,n2objtype,x->dataout,data,gveltptr);              return;              }         if ((err = n2iensuredimeq(&gveltptr,&x->gvelt)))           {             post ("242.dev   : n2iensureimagedimeq err = %ld", err);             return;           }                    if (!x->think)                      srcpixmap   = n2igetpixmap(gveltptr);        else            srcpixmap   = n2igetpixmap(x->gvelt);               if (!x->quarrel)             dstgvelt = x->gvelt;        else            dstgvelt = gveltptr;                         dstpixmap   = n2igetpixmap(dstgvelt);         srcpixztate = n2igetpixstate(srcpixmap);                dstpixztate = n2igetpixstate(dstpixmap);                if (!n2ilockpix(srcpixmap)) return;               if (!n2ilockpix(dstpixmap)) goto ikk;                      srcadresz = n2igetpixaddr(srcpixmap);        dstadresz = n2igetpixaddr(dstpixmap);		roubitez  = n2igetpixrowbytes(srcpixmap);         n2igetdim(gveltptr,&width,&height);        vangh = n2mathdblpi/height;        vangw= n2mathdblpi/width;   //			--	-	cauchy		||		cauchy = Ad13 * tan ( (z-.5) * pi//			--	-	logist		||		l = - (log ( (1-z)/z ) + Bd13 )  /  Ad13//			--	-	hyperbcos		||		hypc =  Ad13 * log ( tan (z*pi / 2))//			--	-	arcsine		||		arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )//			--	-	exponencial	||		expon = - (log (1-z)) / Ad13//			--	-	sinus			||		sinu = Ad13 * sin (SMP&  * vang  * Bd13 )              if (!mode)		//cauchy         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;             k = i % dx;            if (k==0) { 	               z =  map_alpha(x)  ;	                gout = plus +  v1 * tan( (z - .5) * n2mathpi );                      }                                      for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 		         else if (mode == 1)	//logist         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus  - (log(1-z)/z + v2) / v1 ;		}                                      for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 2)	// hyperbcos	hypc =  Ad13 * log ( tan (z*pi / 2))         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  v1 * log( tan(z*n2mathpi/2) ) ;                   }                  for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 3)	// arcsine arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  v1 * (.5 - .5*sin((.5-z)*n2mathpi));                    }                  for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 4)	//expon = - (log (1-z)) / Ad13         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  - (log(1-z)) / v1;                      }                for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 5)	//sinu = Ad13 * sin (SMP&  * vang  * Bd13 )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {   //            z =  map_alpha(x)  ;                gout = plus + v1 * sin (i * vangh * v2);                      }                for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);        n2registerimage(x,n2objtype,x->dataout,data,dstgvelt);        return;        ikk: 	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);}				void nnato_processimage2(NNato *x, n2atom *data){                       long           i, j, k, l, roubitez, pix, gout                      ;                              short          width, height, err, mode = x->mode;                        	long		  		v1 = x->v1,					v2 = x->v2,					plus = x->plus,					dx = x->divx,					dy = x->divy	;	double			z		,  vangh, vangw					;    Ptr            src, dst, srcadresz, dstadresz;          n2pixmaphdl    srcpixmap, dstpixmap;    n2pixstate     srcpixztate, dstpixztate;    n2imgptr       dstgvelt, gveltptr = n2getatomimage(data);        if (!x->on || !gveltptr) return;        if (x->freeze)           {                 n2registerimage(x,n2objtype,x->dataout,data,x->gvelt);              return;           }                       if (x->bypass)           {              n2registerimage(x,n2objtype,x->dataout,data,gveltptr);              return;              }         if ((err = n2iensuredimeq(&gveltptr,&x->gvelt)))           {             post ("242.dev   : n2iensureimagedimeq err = %ld", err);             return;           }                    if (!x->think)                      srcpixmap   = n2igetpixmap(gveltptr);        else            srcpixmap   = n2igetpixmap(x->gvelt);               if (!x->quarrel)             dstgvelt = x->gvelt;        else            dstgvelt = gveltptr;                         dstpixmap   = n2igetpixmap(dstgvelt);         srcpixztate = n2igetpixstate(srcpixmap);                dstpixztate = n2igetpixstate(dstpixmap);                if (!n2ilockpix(srcpixmap)) return;               if (!n2ilockpix(dstpixmap)) goto ikk;                      srcadresz = n2igetpixaddr(srcpixmap);        dstadresz = n2igetpixaddr(dstpixmap);		roubitez  = n2igetpixrowbytes(srcpixmap);         n2igetdim(gveltptr,&width,&height);        vangh = n2mathdblpi/height;        vangw= n2mathdblpi/width;   //			--	-	cauchy		||		cauchy = Ad13 * tan ( (z-.5) * pi//			--	-	logist		||		l = - (log ( (1-z)/z ) + Bd13 )  /  Ad13//			--	-	hyperbcos		||		hypc =  Ad13 * log ( tan (z*pi / 2))//			--	-	arcsine		||		arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )//			--	-	exponencial	||		expon = - (log (1-z)) / Ad13//			--	-	sinus			||		sinu = Ad13 * sin (SMP&  * vang  * Bd13 )              if (!mode)		//cauchy         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                                       for(j = 0; j < width; j++)                 { 	             k = i % dy;	            if (k==0) {	 	               z =  map_alpha(x)  ;		                gout = plus +  v1 * tan( (z - .5) * n2mathpi );	                      }                     pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 		         else if (mode == 1)	//logist         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z =  map_alpha(x)  ;	                gout = plus  - (log(1-z)/z + v2) / v1 ;			}                                          pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 2)	// hyperbcos	hypc =  Ad13 * log ( tan (z*pi / 2))         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z =  map_alpha(x)  ;	                gout = plus +  v1 * log( tan(z*n2mathpi/2) ) ;	                   }                      pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 3)	// arcsine arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z =  map_alpha(x)  ;	                gout = plus +  v1 * (.5 - .5*sin((.5-z)*n2mathpi));	                    }                      pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 4)	//expon = - (log (1-z)) / Ad13         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z =  map_alpha(x)  ;	                gout = plus +  - (log(1-z)) / v1;	                      }                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 5)	//sinu = Ad13 * sin (SMP&  * vang  * Bd13 )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dx;	            if (k==0) {	   //            z =  map_alpha(x)  ;	                gout = plus + v1 * sin (j * vangh * v2);	                      }                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   + gout),					         n2klamp255(n2get32green(pix) + gout),					         n2klamp255(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);        n2registerimage(x,n2objtype,x->dataout,data,dstgvelt);        return;        ikk: 	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);}		void nnato_processimage3(NNato *x, n2atom *data){                       long           i, j, k, l, roubitez, pix, gout                      ;                              short          width, height, err, mode = x->mode;                        	long		  		v1 = x->v1,					v2 = x->v2,					plus = x->plus,					dx = x->divx,					dy = x->divy	;	double			z		,  vangh, vangw					;    Ptr            src, dst, srcadresz, dstadresz;          n2pixmaphdl    srcpixmap, dstpixmap;    n2pixstate     srcpixztate, dstpixztate;    n2imgptr       dstgvelt, gveltptr = n2getatomimage(data);        if (!x->on || !gveltptr) return;        if (x->freeze)           {                 n2registerimage(x,n2objtype,x->dataout,data,x->gvelt);              return;           }                       if (x->bypass)           {              n2registerimage(x,n2objtype,x->dataout,data,gveltptr);              return;              }         if ((err = n2iensuredimeq(&gveltptr,&x->gvelt)))           {             post ("242.dev   : n2iensureimagedimeq err = %ld", err);             return;           }                    if (!x->think)                      srcpixmap   = n2igetpixmap(gveltptr);        else            srcpixmap   = n2igetpixmap(x->gvelt);               if (!x->quarrel)             dstgvelt = x->gvelt;        else            dstgvelt = gveltptr;                         dstpixmap   = n2igetpixmap(dstgvelt);         srcpixztate = n2igetpixstate(srcpixmap);                dstpixztate = n2igetpixstate(dstpixmap);                if (!n2ilockpix(srcpixmap)) return;               if (!n2ilockpix(dstpixmap)) goto ikk;                      srcadresz = n2igetpixaddr(srcpixmap);        dstadresz = n2igetpixaddr(dstpixmap);		roubitez  = n2igetpixrowbytes(srcpixmap);         n2igetdim(gveltptr,&width,&height);        vangh = n2mathdblpi/height;        vangw= n2mathdblpi/width;   //			--	-	cauchy		||		cauchy = Ad13 * tan ( (z-.5) * pi//			--	-	logist		||		l = - (log ( (1-z)/z ) + Bd13 )  /  Ad13//			--	-	hyperbcos		||		hypc =  Ad13 * log ( tan (z*pi / 2))//			--	-	arcsine		||		arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )//			--	-	exponencial	||		expon = - (log (1-z)) / Ad13//			--	-	sinus			||		sinu = Ad13 * sin (SMP&  * vang  * Bd13 )              if (!mode)		//cauchy         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;             k = i % dx;            if (k==0) { 	               z =  map_alpha(x)  ;	                gout = plus +  v1 * tan( (z - .5) * n2mathpi );                      }                                      for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   / gout),					         n2klamp255(n2get32green(pix) / gout),					         n2klamp255(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 } 		         else if (mode == 1)	//logist         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus  - (log(1-z)/z + v2) / v1 ;		}                                      for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   / gout),					         n2klamp255(n2get32green(pix) / gout),					         n2klamp255(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 2)	// hyperbcos	hypc =  Ad13 * log ( tan (z*pi / 2))         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  v1 * log( tan(z*n2mathpi/2) ) ;                   }                  for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   / gout),					         n2klamp255(n2get32green(pix) / gout),					         n2klamp255(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 3)	// arcsine arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  v1 * (.5 - .5*sin((.5-z)*n2mathpi));                    }                  for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   / gout),					         n2klamp255(n2get32green(pix) / gout),					         n2klamp255(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 4)	//expon = - (log (1-z)) / Ad13         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  - (log(1-z)) / v1;                      }                for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   / gout),					         n2klamp255(n2get32green(pix) / gout),					         n2klamp255(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 5)	//sinu = Ad13 * sin (SMP&  * vang  * Bd13 )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {   //            z =  map_alpha(x)  ;                gout = plus + v1 * sin (i * vangh * v2);                      }                for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   / gout),					         n2klamp255(n2get32green(pix) / gout),					         n2klamp255(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);        n2registerimage(x,n2objtype,x->dataout,data,dstgvelt);        return;        ikk: 	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);}		void nnato_processimage4(NNato *x, n2atom *data){                       long           i, j, k, l, roubitez, pix, gout                      ;                              short          width, height, err, mode = x->mode;                        	long		  		v1 = x->v1,					v2 = x->v2,					plus = x->plus,					dx = x->divx,					dy = x->divy	;	double			z		,  vangh, vangw					;    Ptr            src, dst, srcadresz, dstadresz;          n2pixmaphdl    srcpixmap, dstpixmap;    n2pixstate     srcpixztate, dstpixztate;    n2imgptr       dstgvelt, gveltptr = n2getatomimage(data);        if (!x->on || !gveltptr) return;        if (x->freeze)           {                 n2registerimage(x,n2objtype,x->dataout,data,x->gvelt);              return;           }                       if (x->bypass)           {              n2registerimage(x,n2objtype,x->dataout,data,gveltptr);              return;              }         if ((err = n2iensuredimeq(&gveltptr,&x->gvelt)))           {             post ("242.dev   : n2iensureimagedimeq err = %ld", err);             return;           }                    if (!x->think)                      srcpixmap   = n2igetpixmap(gveltptr);        else            srcpixmap   = n2igetpixmap(x->gvelt);               if (!x->quarrel)             dstgvelt = x->gvelt;        else            dstgvelt = gveltptr;                         dstpixmap   = n2igetpixmap(dstgvelt);         srcpixztate = n2igetpixstate(srcpixmap);                dstpixztate = n2igetpixstate(dstpixmap);                if (!n2ilockpix(srcpixmap)) return;               if (!n2ilockpix(dstpixmap)) goto ikk;                      srcadresz = n2igetpixaddr(srcpixmap);        dstadresz = n2igetpixaddr(dstpixmap);		roubitez  = n2igetpixrowbytes(srcpixmap);         n2igetdim(gveltptr,&width,&height);        vangh = n2mathdblpi/height;        vangw= n2mathdblpi/width;   //			--	-	cauchy		||		cauchy = Ad13 * tan ( (z-.5) * pi//			--	-	logist		||		l = - (log ( (1-z)/z ) + Bd13 )  /  Ad13//			--	-	hyperbcos		||		hypc =  Ad13 * log ( tan (z*pi / 2))//			--	-	arcsine		||		arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )//			--	-	exponencial	||		expon = - (log (1-z)) / Ad13//			--	-	sinus			||		sinu = Ad13 * sin (SMP&  * vang  * Bd13 )              if (!mode)		//cauchy         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                                       for(j = 0; j < width; j++)                 { 	             k = i % dy;	            if (k==0) {	 	               z =  map_alpha(x)  ;		                gout = plus +  v1 * tan( (z - .5) * n2mathpi );	                      }                     pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   / gout  + gout),					         n2klamp255(n2get32green(pix) / gout  + gout),					         n2klamp255(n2get32blue(pix)  / gout  +  gout));									    src+=4;				    dst+=4;					                 }		     }		 } 		         else if (mode == 1)	//logist         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z =  map_alpha(x)  ;	                gout = plus  - (log(1-z)/z + v2) / v1 ;			}                                          pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   /gout + gout),					         n2klamp255(n2get32green(pix) / gout + gout),					         n2klamp255(n2get32blue(pix)  /gout + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 2)	// hyperbcos	hypc =  Ad13 * log ( tan (z*pi / 2))         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z =  map_alpha(x)  ;	                gout = plus +  v1 * log( tan(z*n2mathpi/2) ) ;	                   }                      pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix) /gout   + gout),					         n2klamp255(n2get32green(pix) /gout + gout),					         n2klamp255(n2get32blue(pix)  /gout + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 3)	// arcsine arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z =  map_alpha(x)  ;	                gout = plus +  v1 * (.5 - .5*sin((.5-z)*n2mathpi));	                    }                      pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  / gout  + gout),					         n2klamp255(n2get32green(pix) / gout + gout),					         n2klamp255(n2get32blue(pix)  / gout  + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 4)	//expon = - (log (1-z)) / Ad13         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z =  map_alpha(x)  ;	                gout = plus +  - (log(1-z)) / v1;	                      }                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  / gout  + gout),					         n2klamp255(n2get32green(pix) / gout + gout),					         n2klamp255(n2get32blue(pix)  /gout + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 5)	//sinu = Ad13 * sin (SMP&  * vang  * Bd13 )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dx;	            if (k==0) {	   //            z =  map_alpha(x)  ;	                gout = plus + v1 * sin (j * vangh * v2);	                      }                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  /gout + gout),					         n2klamp255(n2get32green(pix) /gout + gout),					         n2klamp255(n2get32blue(pix)  /gout + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);        n2registerimage(x,n2objtype,x->dataout,data,dstgvelt);        return;        ikk: 	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);}		void nnato_processimage5(NNato *x, n2atom *data){                       long           i, j, k, l, roubitez, pix, gout                      ;                              short          width, height, err, mode = x->mode;                        	long		  		v1 = x->v1,					v2 = x->v2,					plus = x->plus,					dx = x->divx,					dy = x->divy	;	double			z		,  vangh, vangw					;    Ptr            src, dst, srcadresz, dstadresz;          n2pixmaphdl    srcpixmap, dstpixmap;    n2pixstate     srcpixztate, dstpixztate;    n2imgptr       dstgvelt, gveltptr = n2getatomimage(data);        if (!x->on || !gveltptr) return;        if (x->freeze)           {                 n2registerimage(x,n2objtype,x->dataout,data,x->gvelt);              return;           }                       if (x->bypass)           {              n2registerimage(x,n2objtype,x->dataout,data,gveltptr);              return;              }         if ((err = n2iensuredimeq(&gveltptr,&x->gvelt)))           {             post ("242.dev   : n2iensureimagedimeq err = %ld", err);             return;           }                    if (!x->think)                      srcpixmap   = n2igetpixmap(gveltptr);        else            srcpixmap   = n2igetpixmap(x->gvelt);               if (!x->quarrel)             dstgvelt = x->gvelt;        else            dstgvelt = gveltptr;                         dstpixmap   = n2igetpixmap(dstgvelt);         srcpixztate = n2igetpixstate(srcpixmap);                dstpixztate = n2igetpixstate(dstpixmap);                if (!n2ilockpix(srcpixmap)) return;               if (!n2ilockpix(dstpixmap)) goto ikk;                      srcadresz = n2igetpixaddr(srcpixmap);        dstadresz = n2igetpixaddr(dstpixmap);		roubitez  = n2igetpixrowbytes(srcpixmap);         n2igetdim(gveltptr,&width,&height);        vangh = n2mathdblpi/height;        vangw= n2mathdblpi/width;   //			--	-	cauchy		||		cauchy = Ad13 * tan ( (z-.5) * pi//			--	-	logist		||		l = - (log ( (1-z)/z ) + Bd13 )  /  Ad13//			--	-	hyperbcos		||		hypc =  Ad13 * log ( tan (z*pi / 2))//			--	-	arcsine		||		arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )//			--	-	exponencial	||		expon = - (log (1-z)) / Ad13//			--	-	sinus			||		sinu = Ad13 * sin (SMP&  * vang  * Bd13 )              if (!mode)		//cauchy         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;             k = i % dx;            if (k==0) { 	               z =  map_alpha(x)  ;	                gout = plus +  v1 * tan( (z - .5) * n2mathpi );                      }                                      for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   / gout),					         n2klamp655(n2get32green(pix) / gout),					         n2klamp655(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 } 		         else if (mode == 1)	//logist         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus  - (log(1-z)/z + v2) / v1 ;		}                                      for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   / gout),					         n2klamp655(n2get32green(pix) / gout),					         n2klamp655(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 2)	// hyperbcos	hypc =  Ad13 * log ( tan (z*pi / 2))         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  v1 * log( tan(z*n2mathpi/2) ) ;                   }                  for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   / gout),					         n2klamp655(n2get32green(pix) / gout),					         n2klamp655(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 3)	// arcsine arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  v1 * (.5 - .5*sin((.5-z)*n2mathpi));                    }                  for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   / gout),					         n2klamp655(n2get32green(pix) / gout),					         n2klamp655(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 4)	//expon = - (log (1-z)) / Ad13         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  - (log(1-z)) / v1;                      }                for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   / gout),					         n2klamp655(n2get32green(pix) / gout),					         n2klamp655(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 5)	//sinu = Ad13 * sin (SMP&  * vang  * Bd13 )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {   //            z =  map_alpha(x)  ;                gout = plus + v1 * sin (i * vangh * v2);                      }                for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   / gout),					         n2klamp655(n2get32green(pix) / gout),					         n2klamp655(n2get32blue(pix)  / gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);        n2registerimage(x,n2objtype,x->dataout,data,dstgvelt);        return;        ikk: 	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);}		void nnato_processimage6(NNato *x, n2atom *data){                       long           i, j, k, l, roubitez, pix, gout                      ;                              short          width, height, err, mode = x->mode;                        	long		  		v1 = x->v1,					v2 = x->v2,					plus = x->plus,					dx = x->divx,					dy = x->divy	;	double			z		,  vangh, vangw					;    Ptr            src, dst, srcadresz, dstadresz;          n2pixmaphdl    srcpixmap, dstpixmap;    n2pixstate     srcpixztate, dstpixztate;    n2imgptr       dstgvelt, gveltptr = n2getatomimage(data);        if (!x->on || !gveltptr) return;        if (x->freeze)           {                 n2registerimage(x,n2objtype,x->dataout,data,x->gvelt);              return;           }                       if (x->bypass)           {              n2registerimage(x,n2objtype,x->dataout,data,gveltptr);              return;              }         if ((err = n2iensuredimeq(&gveltptr,&x->gvelt)))           {             post ("242.dev   : n2iensureimagedimeq err = %ld", err);             return;           }                    if (!x->think)                      srcpixmap   = n2igetpixmap(gveltptr);        else            srcpixmap   = n2igetpixmap(x->gvelt);               if (!x->quarrel)             dstgvelt = x->gvelt;        else            dstgvelt = gveltptr;                         dstpixmap   = n2igetpixmap(dstgvelt);         srcpixztate = n2igetpixstate(srcpixmap);                dstpixztate = n2igetpixstate(dstpixmap);                if (!n2ilockpix(srcpixmap)) return;               if (!n2ilockpix(dstpixmap)) goto ikk;                      srcadresz = n2igetpixaddr(srcpixmap);        dstadresz = n2igetpixaddr(dstpixmap);		roubitez  = n2igetpixrowbytes(srcpixmap);         n2igetdim(gveltptr,&width,&height);        vangh = n2mathdblpi/height;        vangw= n2mathdblpi/width;   //			--	-	cauchy		||		cauchy = Ad13 * tan ( (z-.5) * pi//			--	-	logist		||		l = - (log ( (1-z)/z ) + Bd13 )  /  Ad13//			--	-	hyperbcos		||		hypc =  Ad13 * log ( tan (z*pi / 2))//			--	-	arcsine		||		arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )//			--	-	exponencial	||		expon = - (log (1-z)) / Ad13//			--	-	sinus			||		sinu = Ad13 * sin (SMP&  * vang  * Bd13 )              if (!mode)		//cauchy         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;             k = i % dx;            if (k==0) { 	               z =  map_alpha(x)  ;	                gout = plus +  v1 * tan( (z - .5) * n2mathpi );                      }                                      for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   + gout),					         n2klamp655(n2get32green(pix) + gout),					         n2klamp655(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 		         else if (mode == 1)	//logist         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus  - (log(1-z)/z + v2) / v1 ;		}                                      for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   + gout),					         n2klamp655(n2get32green(pix) + gout),					         n2klamp655(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 2)	// hyperbcos	hypc =  Ad13 * log ( tan (z*pi / 2))         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  v1 * log( tan(z*n2mathpi/2) ) ;                   }                  for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   + gout),					         n2klamp655(n2get32green(pix) + gout),					         n2klamp655(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 3)	// arcsine arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  v1 * (.5 - .5*sin((.5-z)*n2mathpi));                    }                  for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   + gout),					         n2klamp655(n2get32green(pix) + gout),					         n2klamp655(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 4)	//expon = - (log (1-z)) / Ad13         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {               z =  map_alpha(x)  ;                gout = plus +  - (log(1-z)) / v1;                      }                for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   + gout),					         n2klamp655(n2get32green(pix) + gout),					         n2klamp655(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 5)	//sinu = Ad13 * sin (SMP&  * vang  * Bd13 )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;            k = i % dx;            if (k==0) {   //            z =  map_alpha(x)  ;                gout = plus + v1 * sin (i * vangh * v2);                      }                for(j = 0; j < width; j++)                 {                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp655(n2get32red(pix)   + gout),					         n2klamp655(n2get32green(pix) + gout),					         n2klamp655(n2get32blue(pix)  + gout));									    src+=4;				    dst+=4;					                 }		     }		 }  	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);        n2registerimage(x,n2objtype,x->dataout,data,dstgvelt);        return;        ikk: 	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);}		void nnato_processimage7(NNato *x, n2atom *data){                       long           i, j, k, l, roubitez, pix, gout1,gout2,gout3 ,gout                     ;                              short          width, height, err, mode = x->mode;                        	long		  		v1 = x->v1,					v2 = x->v2,					plus = x->plus,					dx = x->divx,					dy = x->divy	;	double			z1,z2,z3,z		,  vangh, vangw					;    Ptr            src, dst, srcadresz, dstadresz;          n2pixmaphdl    srcpixmap, dstpixmap;    n2pixstate     srcpixztate, dstpixztate;    n2imgptr       dstgvelt, gveltptr = n2getatomimage(data);        if (!x->on || !gveltptr) return;        if (x->freeze)           {                 n2registerimage(x,n2objtype,x->dataout,data,x->gvelt);              return;           }                       if (x->bypass)           {              n2registerimage(x,n2objtype,x->dataout,data,gveltptr);              return;              }         if ((err = n2iensuredimeq(&gveltptr,&x->gvelt)))           {             post ("242.dev   : n2iensureimagedimeq err = %ld", err);             return;           }                    if (!x->think)                      srcpixmap   = n2igetpixmap(gveltptr);        else            srcpixmap   = n2igetpixmap(x->gvelt);               if (!x->quarrel)             dstgvelt = x->gvelt;        else            dstgvelt = gveltptr;                         dstpixmap   = n2igetpixmap(dstgvelt);         srcpixztate = n2igetpixstate(srcpixmap);                dstpixztate = n2igetpixstate(dstpixmap);                if (!n2ilockpix(srcpixmap)) return;               if (!n2ilockpix(dstpixmap)) goto ikk;                      srcadresz = n2igetpixaddr(srcpixmap);        dstadresz = n2igetpixaddr(dstpixmap);		roubitez  = n2igetpixrowbytes(srcpixmap);         n2igetdim(gveltptr,&width,&height);        vangh = n2mathdblpi/height;        vangw= n2mathdblpi/width;   //			--	-	cauchy		||		cauchy = Ad13 * tan ( (z-.5) * pi//			--	-	logist		||		l = - (log ( (1-z)/z ) + Bd13 )  /  Ad13//			--	-	hyperbcos		||		hypc =  Ad13 * log ( tan (z*pi / 2))//			--	-	arcsine		||		arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )//			--	-	exponencial	||		expon = - (log (1-z)) / Ad13//			--	-	sinus			||		sinu = Ad13 * sin (SMP&  * vang  * Bd13 )              if (!mode)		//cauchy         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                                       for(j = 0; j < width; j++)                 { 	             k = i % dy;	            if (k==0) {	 	               z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;		                gout1 = plus +  v1 * tan( (z1 - .5) * n2mathpi );		                 gout2 = plus +  v1 * tan( (z2 - .5) * n2mathpi );		                  gout3 = plus +  v1 * tan( (z3 - .5) * n2mathpi );	                      }                     pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  + gout1),					         n2klamp255(n2get32green(pix)  + gout2),					         n2klamp255(n2get32blue(pix)   +  gout3));									    src+=4;				    dst+=4;					                 }		     }		 } 		         else if (mode == 1)	//logist         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus  - (log(1-z1)/z1 + v2) / v1 ;	                gout2 = plus  - (log(1-z2)/z2 + v2) / v1 ;	                gout3 = plus  - (log(1-z3)/z3 + v2) / v1 ;			}                                          pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   /gout1 ),					         n2klamp255(n2get32green(pix) / gout2 ),					         n2klamp255(n2get32blue(pix)  /gout3 ));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 2)	// hyperbcos	hypc =  Ad13 * log ( tan (z*pi / 2))         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	              z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus +  v1 * log( tan(z1*n2mathpi/2) ) ;	                gout2 = plus +  v1 * log( tan(z2*n2mathpi/2) ) ;	                gout3 = plus +  v1 * log( tan(z3*n2mathpi/2) ) ;	                   }                      pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix) /gout1   + gout1),					         n2klamp255(n2get32green(pix) /gout2+ gout2),					         n2klamp255(n2get32blue(pix)  /gout3 + gout3));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 3)	// arcsine arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	                 z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus +  v1 * (.5 - .5*sin((.5-z1)*n2mathpi));	                gout2 = plus +  v1 * (.5 - .5*sin((.5-z2)*n2mathpi));	                gout3 = plus +  v1 * (.5 - .5*sin((.5-z3)*n2mathpi));	                    }                      pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  / gout1  + gout1),					         n2klamp255(n2get32green(pix) / gout2 + gout2),					         n2klamp255(n2get32blue(pix)  / gout3  + gout3));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 4)	//expon = - (log (1-z)) / Ad13         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	              z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus +  - (log(1-z1)) / v1;	                gout2 = plus +  - (log(1-z2)) / v1;	                gout3 = plus +  - (log(1-z3)) / v1;	                      }                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  / gout1  + gout1),					         n2klamp255(n2get32green(pix) / gout2 + gout2),					         n2klamp255(n2get32blue(pix)  /gout3 + gout3));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 5)	//sinu = Ad13 * sin (SMP&  * vang  * Bd13 )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dx;	            if (k==0) {	   z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus + v1 * sin (z1+j * vangh * v2);	                gout2 = plus + v1 * sin (z2+j * vangh * v2);	                gout3 = plus + v1 * sin (z3+j * vangh * v2);	                      }                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  /gout1 + gout1),					         n2klamp255(n2get32green(pix) /gout2 + gout2),					         n2klamp255(n2get32blue(pix)  /gout3 + gout3));									    src+=4;				    dst+=4;					                 }		     }		 }  	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);        n2registerimage(x,n2objtype,x->dataout,data,dstgvelt);        return;        ikk: 	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);}void nnato_processimage8(NNato *x, n2atom *data){                       long           i, j, k, l, roubitez, pix, gout1,gout2,gout3 ,gout                     ;                              short          width, height, err, mode = x->mode;                        	long		  		v1 = x->v1,					v2 = x->v2,					plus = x->plus,					dx = x->divx,					dy = x->divy	;	double			z1,z2,z3,z		,  vangh, vangw					;    Ptr            src, dst, srcadresz, dstadresz;          n2pixmaphdl    srcpixmap, dstpixmap;    n2pixstate     srcpixztate, dstpixztate;    n2imgptr       dstgvelt, gveltptr = n2getatomimage(data);        if (!x->on || !gveltptr) return;        if (x->freeze)           {                 n2registerimage(x,n2objtype,x->dataout,data,x->gvelt);              return;           }                       if (x->bypass)           {              n2registerimage(x,n2objtype,x->dataout,data,gveltptr);              return;              }         if ((err = n2iensuredimeq(&gveltptr,&x->gvelt)))           {             post ("242.dev   : n2iensureimagedimeq err = %ld", err);             return;           }                    if (!x->think)                      srcpixmap   = n2igetpixmap(gveltptr);        else            srcpixmap   = n2igetpixmap(x->gvelt);               if (!x->quarrel)             dstgvelt = x->gvelt;        else            dstgvelt = gveltptr;                         dstpixmap   = n2igetpixmap(dstgvelt);         srcpixztate = n2igetpixstate(srcpixmap);                dstpixztate = n2igetpixstate(dstpixmap);                if (!n2ilockpix(srcpixmap)) return;               if (!n2ilockpix(dstpixmap)) goto ikk;                      srcadresz = n2igetpixaddr(srcpixmap);        dstadresz = n2igetpixaddr(dstpixmap);		roubitez  = n2igetpixrowbytes(srcpixmap);         n2igetdim(gveltptr,&width,&height);        vangh = n2mathdblpi/height;        vangw= n2mathdblpi/width;   //			--	-	cauchy		||		cauchy = Ad13 * tan ( (z-.5) * pi//			--	-	logist		||		l = - (log ( (1-z)/z ) + Bd13 )  /  Ad13//			--	-	hyperbcos		||		hypc =  Ad13 * log ( tan (z*pi / 2))//			--	-	arcsine		||		arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )//			--	-	exponencial	||		expon = - (log (1-z)) / Ad13//			--	-	sinus			||		sinu = Ad13 * sin (SMP&  * vang  * Bd13 )              if (!mode)		//cauchy         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                                       for(j = 0; j < width; j++)                 { 	             k = j % dy;	            if (k==0) {	 	               z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                      } 		                gout1 = plus +  v1 * tan( (z1 - .5) * n2mathpi );		                 gout2 = plus +  v1 * tan( (z2 - .5) * n2mathpi );		                  gout3 = plus +  v1 * tan( (z3 - .5) * n2mathpi );                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  + gout1),					         n2klamp255(n2get32green(pix)  + gout2),					         n2klamp255(n2get32blue(pix)   +  gout3));									    src+=4;				    dst+=4;					                 }		     }		 } 		         else if (mode == 1)	//logist         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus  - (log(1-z1)/z1 + v2) / v1 ;	                gout2 = plus  - (log(1-z2)/z2 + v2) / v1 ;	                gout3 = plus  - (log(1-z3)/z3 + v2) / v1 ;			}                                          pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   /gout1 ),					         n2klamp255(n2get32green(pix) / gout2 ),					         n2klamp255(n2get32blue(pix)  /gout3 ));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 2)	// hyperbcos	hypc =  Ad13 * log ( tan (z*pi / 2))         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	              z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus +  v1 * log( tan(z1*n2mathpi/2) ) ;	                gout2 = plus +  v1 * log( tan(z2*n2mathpi/2) ) ;	                gout3 = plus +  v1 * log( tan(z3*n2mathpi/2) ) ;	                   }                      pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix) /gout1   + gout1),					         n2klamp255(n2get32green(pix) /gout2+ gout2),					         n2klamp255(n2get32blue(pix)  /gout3 + gout3));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 3)	// arcsine arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	                 z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus +  v1 * (.5 - .5*sin((.5-z1)*n2mathpi));	                gout2 = plus +  v1 * (.5 - .5*sin((.5-z2)*n2mathpi));	                gout3 = plus +  v1 * (.5 - .5*sin((.5-z3)*n2mathpi));	                    }                      pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  / gout1  + gout1),					         n2klamp255(n2get32green(pix) / gout2 + gout2),					         n2klamp255(n2get32blue(pix)  / gout3  + gout3));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 4)	//expon = - (log (1-z)) / Ad13         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	              z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus +  - (log(1-z1)) / v1;	                gout2 = plus +  - (log(1-z2)) / v1;	                gout3 = plus +  - (log(1-z3)) / v1;	                      }                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  / gout1  + gout1),					         n2klamp255(n2get32green(pix) / gout2 + gout2),					         n2klamp255(n2get32blue(pix)  /gout3 + gout3));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 5)	//sinu = Ad13 * sin (SMP&  * vang  * Bd13 )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dx;	            if (k==0) {	   z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus + v1 * sin (z1+j * vangh * v2);	                gout2 = plus + v1 * sin (z2+j * vangh * v2);	                gout3 = plus + v1 * sin (z3+j * vangh * v2);	                      }                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  /gout1 + gout1),					         n2klamp255(n2get32green(pix) /gout2 + gout2),					         n2klamp255(n2get32blue(pix)  /gout3 + gout3));									    src+=4;				    dst+=4;					                 }		     }		 }  	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);        n2registerimage(x,n2objtype,x->dataout,data,dstgvelt);        return;        ikk: 	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);}void nnato_processimage9(NNato *x, n2atom *data){                       long           i, j, k, l, roubitez, pix, gout1,gout2,gout3 ,gout                     ;                              short          width, height, err, mode = x->mode;                        	long		  		v1 = x->v1,					v2 = x->v2,					plus = x->plus,					dx = x->divx,					dy = x->divy	;	double			z1,z2,z3,z		,  vangh, vangw					;    Ptr            src, dst, srcadresz, dstadresz;          n2pixmaphdl    srcpixmap, dstpixmap;    n2pixstate     srcpixztate, dstpixztate;    n2imgptr       dstgvelt, gveltptr = n2getatomimage(data);        if (!x->on || !gveltptr) return;        if (x->freeze)           {                 n2registerimage(x,n2objtype,x->dataout,data,x->gvelt);              return;           }                       if (x->bypass)           {              n2registerimage(x,n2objtype,x->dataout,data,gveltptr);              return;              }         if ((err = n2iensuredimeq(&gveltptr,&x->gvelt)))           {             post ("242.dev   : n2iensureimagedimeq err = %ld", err);             return;           }                    if (!x->think)                      srcpixmap   = n2igetpixmap(gveltptr);        else            srcpixmap   = n2igetpixmap(x->gvelt);               if (!x->quarrel)             dstgvelt = x->gvelt;        else            dstgvelt = gveltptr;                         dstpixmap   = n2igetpixmap(dstgvelt);         srcpixztate = n2igetpixstate(srcpixmap);                dstpixztate = n2igetpixstate(dstpixmap);                if (!n2ilockpix(srcpixmap)) return;               if (!n2ilockpix(dstpixmap)) goto ikk;                      srcadresz = n2igetpixaddr(srcpixmap);        dstadresz = n2igetpixaddr(dstpixmap);		roubitez  = n2igetpixrowbytes(srcpixmap);         n2igetdim(gveltptr,&width,&height);        vangh = n2mathdblpi/height;        vangw= n2mathdblpi/width;   //			--	-	cauchy		||		cauchy = Ad13 * tan ( (z-.5) * pi//			--	-	logist		||		l = - (log ( (1-z)/z ) + Bd13 )  /  Ad13//			--	-	hyperbcos		||		hypc =  Ad13 * log ( tan (z*pi / 2))//			--	-	arcsine		||		arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )//			--	-	exponencial	||		expon = - (log (1-z)) / Ad13//			--	-	sinus			||		sinu = Ad13 * sin (SMP&  * vang  * Bd13 )              if (!mode)		//cauchy         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                                       for(j = 0; j < width; j++)                 { 	             k = j % dy;	            if (k==0) {	 	               z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                      } 		                gout1 = plus +  v1 * tan( (z3 - .5) * n2mathpi );		                 gout2 = plus +  v1 * tan( (z3 - .5) * n2mathpi );		                  gout3 = plus +  v1 * tan( (z3 - .5) * n2mathpi );                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  + gout1),					         n2klamp255(n2get32green(pix)  + gout2),					         n2klamp255(n2get32blue(pix)   +  gout3));									    src+=4;				    dst+=4;					                 }		     }		 } 		         else if (mode == 1)	//logist         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	               z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus  - (log(1-z1)/z1 + v2) / v1 ;	                gout2 = plus  - (log(1-z2)/z2 + v2) / v1 ;	                gout3 = plus  - (log(1-z3)/z3 + v2) / v1 ;			}                                          pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)   /gout1 ),					         n2klamp255(n2get32green(pix) / gout2 ),					         n2klamp255(n2get32blue(pix)  /gout3 ));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 2)	// hyperbcos	hypc =  Ad13 * log ( tan (z*pi / 2))         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	              z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus +  v1 * log( tan(z1*n2mathpi/2) ) ;	                gout2 = plus +  v1 * log( tan(z2*n2mathpi/2) ) ;	                gout3 = plus +  v1 * log( tan(z3*n2mathpi/2) ) ;	                   }                      pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix) /gout1   + gout1),					         n2klamp255(n2get32green(pix) /gout2+ gout2),					         n2klamp255(n2get32blue(pix)  /gout3 + gout3));									    src+=4;				    dst+=4;					                 }		     }		 } 	 else if (mode == 3)	// arcsine arcs =  Ad13 * (.5 - .5 * sin( (.5-z) * pi )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	                 z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus +  v1 * (.5 - .5*sin((.5-z1)*n2mathpi));	                gout2 = plus +  v1 * (.5 - .5*sin((.5-z2)*n2mathpi));	                gout3 = plus +  v1 * (.5 - .5*sin((.5-z3)*n2mathpi));	                    }                      pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  / gout1  + gout1),					         n2klamp255(n2get32green(pix) / gout2 + gout2),					         n2klamp255(n2get32blue(pix)  / gout3  + gout3));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 4)	//expon = - (log (1-z)) / Ad13         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dy;	            if (k==0) {	              z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus +  - (log(1-z1)) / v1;	                gout2 = plus +  - (log(1-z2)) / v1;	                gout3 = plus +  - (log(1-z3)) / v1;	                      }                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  / gout1  + gout1),					         n2klamp255(n2get32green(pix) / gout2 + gout2),					         n2klamp255(n2get32blue(pix)  /gout3 + gout3));									    src+=4;				    dst+=4;					                 }		     }		 }  	 else if (mode == 5)	//sinu = Ad13 * sin (SMP&  * vang  * Bd13 )         {               for(i = 0; i < height; i++)   				             {                src = srcadresz + i * roubitez;                            dst = dstadresz + i * roubitez;                for(j = 0; j < width; j++)                 {	            k = i % dx;	            if (k==0) {	   z1 =  map_alpha(x)  ; z2 =  map_alpha(x)  ; z3 =  map_alpha(x)  ;	                gout1 = plus + v1 * sin (z1+j * vangh * v2);	                gout2 = plus + v1 * sin (z2+j * vangh * v2);	                gout3 = plus + v1 * sin (z3+j * vangh * v2);	                      }                    pix = n2get32(src);					n2set32m(dst,					         n2get32alpha(pix),					         n2klamp255(n2get32red(pix)  /gout1 + gout1),					         n2klamp255(n2get32green(pix) /gout2 + gout2),					         n2klamp255(n2get32blue(pix)  /gout3 + gout3));									    src+=4;				    dst+=4;					                 }		     }		 }  	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);        n2registerimage(x,n2objtype,x->dataout,data,dstgvelt);        return;        ikk: 	    n2isetpixstate(srcpixmap,srcpixztate);        n2isetpixstate(dstpixmap,dstpixztate);}